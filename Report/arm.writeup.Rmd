---
title: <center>Exogenous Risk Factors and Statewide Pension Funding</center>
geometry: margin=1in
output:
  html_document:
    theme: readable

    
---


```{r, echo=FALSE}
#Title page and abstract
#Introduction
#Background/Literature section: here you describe the data, its source, what question will the data help answer, and why this question is important.
#Data and analysis section: descriptive statistics and summary of all variables used in the analysis, hypotheses being tested, and analyses (ANOVA, regression).
#Results and key findings section
#Conclusion

```

<style type="text/css">
div.main-container {
  max-width: 1800px !important;
  margin-left: auto;
  margin-right: auto;
}
</style>

<center>
## By Corban Nemeth
## The Evergreen State College
</center>

&nbsp;

\pagebreak

##Abstract 
State budgets have yet to recover from the Great Recession. One key driver of state budget priorities are pension plans for public employees. This paper looks at factors exogenous to statewide pension plans to examine what may impact the funded status of a given retirement system. The sample in this study is 110 retirement systems adminstered by state governments. The exogenous factors included in the analysis are partisan control of a state's legislature and governership, the size of state employment adjusted for the total population in the state, the number of public state employees represented by a union, the tax revenue of the state government, and the per capita GDP of the state.   

<br>

##Background
What, if any, impacts do environmental factors have on the funded status of state public employee pension plans? This study looks at factors outside of the direct control of pension plan adminstrators to examine the relationships between several risk factors and the effect that those factors have on plan funded status. The data for this study was compiled from several sources. The primary data on statewide pension plans came from the Public Plans Database at the Center for Retirement Research. Data on statewide tax revenue was compiled from Pew Charitable Trust. Partisan composition of state legislatures and governerships was obtained from the National Conference of State Legislatures. State gross domestic product per capita was from the Bureau of Economic Analysis. State employment and union participation data was Governing and the Bureau of Labor Statistics. These factors were combined into a dataset in R for purposes of this research exercise. If significant risk factors are detected, then pension plan adminsistrators can identify the risk level of their retirement environment and respond proactively to manage funding challenges. 

##Data and Analysis

To begin, the data was loaded from the sources listed above and combined into a single dataframe. All data is for fiscal year 2017, except for union participation which is year-end 2016.
```{r warning=FALSE, message=FALSE}
library(tidyverse)
library(reshape2)
tax.data <- read_csv("../Data/TaxRevenue.csv") # from https://www.pewtrusts.org/en/research-and-analysis/data-visualizations/2014/fiscal-50#ind0 , 4th quarter 2017 4 qtr rolling average
partisan.data <- read_csv("../Data/partisanComposition.csv") #from http://www.ncsl.org/Portals/1/Documents/Elections/Legis_Control_2017_March_1_9%20am.pdf
pension.data <- read_csv("../Data/PPD_PlanLevel.csv") # from http://publicplansdata.org/public-plans-database/the-2018-data-update/
gdp.data <- read_csv("../Data/percapgdp.csv") # from https://apps.bea.gov/itable/iTable.cfm?ReqID=70&step=1#reqid=70&step=1&isuri=1 
emp.data <- read_csv("../Data/emp.data.csv") # from http://www.governing.com/gov-data/public-workforce-salaries/states-most-government-workers-public-employees-by-job-type.html
union.data <- read_csv("../Data/uniondata.csv")   # from http://www.governing.com/gov-data/public-workforce-salaries/union-membership-affiliation-by-state-data-statistics.html


tax.data <- tax.data %>% 
  select(-c(X52, X53))
tax.data <- melt(tax.data) %>% 
  filter(QtrRolAvg == "2017Q4") %>% #4QtrRolAvg dollars in thousands
  rename(BudgRev = value, GovtName = variable)
  
pension.data <- pension.data %>% 
  filter(fy == 2017) %>% 
  inner_join(partisan.data, by = "GovtName") %>% #removes local govts from data set
  left_join(tax.data, by = "GovtName") %>% 
  left_join(gdp.data, by = "GovtName") %>% 
  left_join(emp.data, by = "GovtName") %>% 
  left_join(union.data, by = "GovtName") %>% 
  select(fy, PlanFullName, GovtName, PerCapGDP, ActFundedRatio_GASB, UAAL_GASB, BudgRev, LegControl, GovParty, TotMembership, state_emp_per_tenk_pop, UnionRep)

model.data <- pension.data %>% 
  select(ActFundedRatio_GASB, PerCapGDP, BudgRev, state_emp_per_tenk_pop, UnionRep, LegControl, GovParty)
attach(model.data)
```
   
Below are plots that look at the interactions present within the data. The following scatterplot matrix examines the relationships between the continuous terms. 

```{r warning=FALSE, message=FALSE, fig.align= 'center'}
library(GGally)
ggpairs(model.data) + 
        theme(axis.line=element_blank(),
        axis.text=element_blank(),
        axis.ticks=element_blank())
```


Some elements do not appear to be normally distributed. However, the response variable appears normal and meets the assumptions for linear regression with levels for the categorical indicators LegControl and GovParty. Transformations can be made to Budget Revenue, State Employment, and Union Representation to improve symmetry. 

```{r}
hist(log(BudgRev))
hist(log(state_emp_per_tenk_pop))
hist(log(UnionRep))
```


The LM regression model is created to include the plan's funded ratio as the response variable. A stepwise algorithm is used to determine the optimal model fit. 
```{r}
pension.model <- lm(ActFundedRatio_GASB ~ LegControl*GovParty+log(state_emp_per_tenk_pop)*log(UnionRep)+log(BudgRev)*PerCapGDP)
summary(pension.model)
model1 <- step(pension.model)
summary(model1)
```















